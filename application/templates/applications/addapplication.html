{% extends 'main_app/base.html' %}
{% load static %}

{% block content %}


{% if user.is_authenticated %} 
<body class="m-5">
    <div class="container">
        <div class="row justify-content-center"> 
            <div class="col-md-6">
                <div class="card">
                    <form method='POST' action="{% url 'addapplication' %}" enctype="multipart/form-data">
                        {% csrf_token %}
                        {{ form.media }}
                        <div class="form-group m-3">
                            <label>Full_Names</label>
                            <input required name="student" type="text" placeholder="Enter Full_Names"
                                class="form-control">
                        </div>
                        <div class="form-group m-3">
                            <label>Address</label>
                            <input required name="address" type="text" placeholder="Enter address and Postal Code"
                                class="form-control">
                        </div>
                        <div class="form-group m-3">
                            <label>Disability</label>
                            <input required name="disability" type="text" placeholder="Any disabity 'yes: state' or 'No'"
                                class="form-control">
                        </div>
                        <style>
                            /* Customizing tooltip appearance */
                            #instruction1Tooltip {
                                display: none;
                                position: absolute;
                                background-color: #f8f9fa; /* Change tooltip background color */
                                border: 1px solid #6c757d; /* Change tooltip border color */
                                border-radius: 4px; /* Rounded corners */
                                padding: 10px; /* Increase padding */
                                max-width: 300px; /* Set maximum width */
                                font-size: 14px; /* Adjust font size */
                                color: #212529; /* Change text color */
                                z-index: 9999; /* Ensure tooltip is above other elements */
                            }
                        </style>
                        
                        <script>
                            // Function to show the instruction tooltip
                            function showInstruction1() {
                                $('#instruction1Tooltip').css('display', 'block'); // Show the tooltip
                            }
                        
                            // Function to hide the instruction tooltip
                            function hideInstruction1() {
                                $('#instruction1Tooltip').css('display', 'none'); // Hide the tooltip
                            }
                        </script>
                        <!-- Select university -->
                        <div class="form-group m-3">
                            <label>Select a University_first choice</label>
                            <select name="university" class="form-control">
                                <option value='none'>Select a university...</option>
                                {% for university in universitys %}
                                <option value='{{university.id}}'>{{university.name}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <!-- Create a new university -->
                        <div class="form-group m-3">
                            <label>Add new first_choice</label>
                            <input name="university_new" type="text" placeholder="Add a new university first_choice"
                                class="form-control">
                        </div>

                        <div class="form-group m-3">
                            <label>University</label>
                            <input name="varsity" type="text" placeholder="Name of the Universities"
                                class="form-control" onfocus="showInstruction1()" onblur="hideInstruction1()">
                            <div id="instruction1Tooltip">
                               <strong>Note:Your first university you enter is the first choice:</stong> CTU, WITS, UJ, PTA, UP, UFS, UWS, SUN, NMU, UFH, UL, UNIVEN, for more click WAITLIST&scroll to prospectors'
                            </div>
                        </div>
                       
                        
                        <style>
                            /* Customizing tooltip appearance */
                            #instructionTooltip {
                                display: none;
                                position: absolute;
                                background-color: #f8f9fa; /* Change tooltip background color */
                                border: 1px solid #6c757d; /* Change tooltip border color */
                                border-radius: 4px; /* Rounded corners */
                                padding: 10px; /* Increase padding */
                                max-width: 300px; /* Set maximum width */
                                font-size: 14px; /* Adjust font size */
                                color: #212529; /* Change text color */
                                z-index: 9999; /* Ensure tooltip is above other elements */
                            }
                        </style>
                        
                        <script>
                            // Function to show the instruction tooltip
                            function showInstruction() {
                                $('#instructionTooltip').css('display', 'block'); // Show the tooltip
                            }
                        
                            // Function to hide the instruction tooltip
                            function hideInstruction() {
                                $('#instructionTooltip').css('display', 'none'); // Hide the tooltip
                            }
                        </script>
                        
                        <style>
                            /* Customizing tooltip appearance */
                            #instructionTooltip {
                                display: none;
                                position: absolute;
                                background-color: #f8f9fa; /* Change tooltip background color */
                                border: 1px solid #6c757d; /* Change tooltip border color */
                                border-radius: 4px; /* Rounded corners */
                                padding: 10px; /* Increase padding */
                                max-width: 300px; /* Set maximum width */
                                font-size: 14px; /* Adjust font size */
                                color: #212529; /* Change text color */
                                z-index: 9999; /* Ensure tooltip is above other elements */
                            }
                        </style>
                        
                        <script>
                            // Function to show the instruction tooltip
                            function showInstruction() {
                                $('#instructionTooltip').css('display', 'block'); // Show the tooltip
                            }
                        
                            // Function to hide the instruction tooltip
                            function hideInstruction() {
                                $('#instructionTooltip').css('display', 'none'); // Hide the tooltip
                            }
                        </script>
                        <script>
                            // Function to show the instruction tooltip
                            function showInstruction2() {
                                $('#instruction2Tooltip').css('display', 'block'); // Show the tooltip
                            }
                        
                            // Function to hide the instruction tooltip
                            function hideInstruction2() {
                                $('#instruction2Tooltip').css('display', 'none'); // Hide the tooltip
                            }
                        </script>
                        <style>
                            /* Customizing tooltip appearance */
                            #instruction2Tooltip {
                                display: none;
                                position: absolute;
                                background-color: #f8f9fa; /* Change tooltip background color */
                                border: 1px solid #6c757d; /* Change tooltip border color */
                                border-radius: 4px; /* Rounded corners */
                                padding: 10px; /* Increase padding */
                                max-width: 300px; /* Set maximum width */
                                font-size: 14px; /* Adjust font size */
                                color: #212529; /* Change text color */
                                z-index: 9999; /* Ensure tooltip is above other elements */
                            }
                        </style>
                        <div class="form-group m-3">
                            <label>Bursary</label>
                            <input name="bursary" type="text" placeholder="bursary name"
                                class="form-control" onfocus="showInstruction2()" onblur="hideInstruction2()">
                            <div id="instruction2Tooltip">
                               <strong>"Note: Please also include the names of any bursaries for which we should apply on your behalf."</stong>e.g NSFAS, FUNDZA LUSHAKA, ISFAP, NEDBANK, PATRICE MOTSEPE FOUNDATION, SASOL more: zabursaries.co.za'
                            </div>
                        </div>

                        <div class="form-group m-3">
                            <label>Details</label>
                            <input name="details" type="text" placeholder="Courses/Faculty, Gender, Marital-status, Home Lang, Citizenship, Race, Email, Contact, Id-Number, Birth Date, School-Leaving-Name"
                                class="form-control" onfocus="showInstruction()" onblur="hideInstruction()">
                            <div id="instructionTooltip">
                               <strong>Note:Also include which university per course specified:</stong> Courses/Faculty, Gender, Marital-status, Home Lang, Citizenship, Race, Email, Contact, Id-Number, Birth Date, School-Leaving-Name'
                            </div>
                        </div>
                                    
                        <!-- Upload image -->
                        <div class="form-group m-3">
                            <label>Upload Your Image</label>
                            <div class="input-group">
                                <div class="custom-file">
                                    <input required name="image" type="file" class="custom-file-input" id="imageInput" accept="image/*" style="display: none;">
                                    <label class="custom-file-label" for="imageInput">
                                        <span id="fileInputLabel">+</span> <!-- Placeholder for image icon -->
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div id="imagePreview" class="form-group m-3" style="display: none;">
                            <label>Image Preview</label>
                            <img id="previewImage" src="#" alt="Image Preview" style="max-width: 100%;">
                            <button type="button" class="btn btn-danger" onclick="cancelImagePreview()">Cancel</button>
                        </div>
                        <script>
                            // Function to show the instruction tooltip
                            function showInstructions() {
                                $('#instructionsTooltip').css('display', 'block'); // Show the tooltip
                            }
                        
                            // Function to hide the instruction tooltip
                            function hideInstructions() {
                                $('#instructionsTooltip').css('display', 'none'); // Hide the tooltip
                            }
                        </script>
                        <!-- Next of keen -->
                        <style>
                            /* Customizing tooltip appearance */
                            #instructionsTooltip {
                                display: none;
                                position: absolute;
                                background-color: #f8f9fa; /* Change tooltip background color */
                                border: 1px solid #6c757d; /* Change tooltip border color */
                                border-radius: 4px; /* Rounded corners */
                                padding: 10px; /* Increase padding */
                                max-width: 300px; /* Set maximum width */
                                font-size: 14px; /* Adjust font size */
                                color: #212529; /* Change text color */
                                z-index: 9999; /* Ensure tooltip is above other elements */
                            }
                        </style>
                        <div class="form-group m-3">
                            <label>Next of Keen</label>
                            <input name="keen" type="text" placeholder="Full_Names,address,PhoneNumbers,Telephone"
                                class="form-control" onfocus="showInstructions()" onblur="hideInstructions()">
                            <div id="instructionsTooltip">
                                Full_Names,address and Postal Code,PhoneNumbers,Telephone'
                            </div>
                        </div>
                        <style>
                            /* Style the dropdown background color */
                            select#urlType {
                                background-color: #3c344d; /* Change this to your desired background color */
                                color: #af5d5d; /* Change this to your desired text color */
                                border: 1px solid #271b5c; /* Add border if needed */
                                /* Add any other styling you want */
                            }
                            
                            /* Style the dropdown options */
                            select#urlType option {
                                background-color: #f2f2f2; /* Change this to your desired background color */
                                color: #99645b; /* Change this to your desired text color */
                                /* Add any other styling for options */
                            }
                        </style>
                        <!-- Dropdown for URL Type -->
                        
                        <button type='submit' class="btn btn-primary m-3">Submit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</body>

<!-- JavaScript to dynamically add and remove URL input fields -->
<script>
    function addUrlField() {
        const urlTypeDropdown = document.getElementById('urlType');
        const dynamicUrlFields = document.getElementById('dynamicUrlFields');

        // Get the selected URL type
        const selectedUrlType = urlTypeDropdown.value;

        if (selectedUrlType) {
            const urlField = document.createElement('div');
            urlField.className = 'form-group m-3';

            const label = document.createElement('label');
            label.textContent = selectedUrlType.replace("_", " ").toUpperCase();
            urlField.appendChild(label);

            const input = document.createElement('input');
            input.name = selectedUrlType;
            input.type = 'text';
            input.placeholder = 'Enter ' + selectedUrlType.replace("_", " ");
            input.className = 'form-control';
            urlField.appendChild(input);

            const deleteButton = document.createElement('button');
            deleteButton.type = 'button';
            deleteButton.className = 'btn btn-danger';
            deleteButton.textContent = 'Delete';
            deleteButton.addEventListener('click', function() {
                dynamicUrlFields.removeChild(urlField);
            });
            urlField.appendChild(deleteButton);

            dynamicUrlFields.appendChild(urlField);
        }
    }

    function cancelImagePreview() {
        const imageInput = document.getElementById('imageInput');
        const imagePreview = document.getElementById('imagePreview');
        const previewImage = document.getElementById('previewImage');

        imageInput.value = ''; // Clear the input
        previewImage.src = '#';
        imagePreview.style.display = 'none';
    }

    // Handle image preview when a file is selected
    const imageInput = document.getElementById('imageInput');
    const imagePreview = document.getElementById('imagePreview');
    const previewImage = document.getElementById('previewImage');

    imageInput.addEventListener('change', function(event) {
        const selectedImage = event.target.files[0];
        if (selectedImage) {
            previewImage.src = URL.createObjectURL(selectedImage);
            imagePreview.style.display = 'block';
        }
    });
</script>
{% else %}
<div class="container mt-3"></div>
 <div class="d-flex justify-content-center justify-content-md-start">
    <div class="text-center me-3">
    <div class="alert alert-success alert-dismissible fade show mb-0" role="alert">
        <a><strong>NOTICE!</strong></a>
        <a class="btn btn-danger bi bi-person" target="_blank" href="{% url 'login_page' %}" role="button">
        Login
        </a>
        <a class="btn btn-secondary bi bi-person" target="_blank" href="{% url 'register_selection' %}" role="button">
        Create account</a>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button> 
    </div> 
 </div>
</div>
{% endif %}
{% endblock %}
